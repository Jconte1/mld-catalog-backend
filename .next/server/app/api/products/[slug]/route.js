"use strict";(()=>{var e={};e.id=39,e.ids=[39],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7793:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>E,patchFetch:()=>A,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>R,staticGenerationAsyncStorage:()=>f});var i={};t.r(i),t.d(i,{GET:()=>c,OPTIONS:()=>_});var a=t(9303),n=t(8716),s=t(670),l=t(6318);let u=["OUTDOOR GRILLS","RANGES","COOKTOPS AND RANGETOPS","BUILT IN OVENS","WARMING DRAWERS","VENTILATION","MICROWAVE","FREEZERS","REFRIGERATORS","COFFEE SYSTEMS","ICE MAKERS","DISHWASHERS","LAUNDRY"];function o(e){if(!e)return 0;let r=0;return e.includes(".jpg")&&(r+=2),e.includes("?")||(r+=1),r}function d(){return{"Access-Control-Allow-Origin":"https://www.mld.com","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,PATCH,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization",Vary:"Origin"}}function _(){return new Response(null,{status:204,headers:d()})}async function c(e,{params:r}){let{slug:t}=r;try{let e=await l.Z.products.findFirst({where:{slug:{equals:t,mode:"insensitive"}},select:{id:!0,slug:!0,model:!0,brand:!0,major:!0,minor:!0,type:!0,data:!0}});if(!e)return Response.json({error:"Product not found"},{status:404,headers:d()});let r=function(e,r,t){let i=e?.data?.classification||e?.classification||{},a=e?.data?.marketing_copy||e?.marketing_copy||{},n=e?.data?.media||e?.media||{},s=e?.data?.managed_data||e?.managed_data||{},l="string"==typeof i?.manufacturer_pn&&i.manufacturer_pn.trim()?i.manufacturer_pn:"string"==typeof i?.pn&&i.pn.trim()?i.pn:"Model not available",d=i.pn||"",_=i.brand_name||"Unknown",c=i.width_string||null,p=i.height_string||null,m=i.depth_string||null,f=a?.short_description||"Unnamed Product",R=a?.short_description||"",E=a?.paragraph_description||"",A=a?.features?.feature,g=Array.isArray(A)?A:"string"==typeof A?[A]:[],S=a?.hierarchical_features_html||"",h=(Array.isArray(a?.image_features?.image_feature)?a.image_features.image_feature:a?.image_features?.image_feature?[a.image_features.image_feature]:[]).map(e=>({title:e.title||"",feature_description:e.feature_description||"",image_file_name:e.image_file_name||""})),O=Array.isArray(a?.spec_table_as_key_value_pairs)?a.spec_table_as_key_value_pairs:[],y=Array.isArray(n?.pdfs?.pdf)?n.pdfs.pdf:n?.pdfs?.pdf?[n.pdfs.pdf]:[],C=Array.isArray(n?.images?.image)?n.images.image:n?.images?.image?[n.images.image]:[],I=function(e){if(!Array.isArray(e))return"";let r=e.sort((e,r)=>{let t=e.full_size_url||"";return o(r.full_size_url||"")-o(t)});return r[0]?.full_size_url||""}(C),T=C.map(e=>({file_name:e.file_name||"",full_size_url:e.full_size_url||"",thumbnail_url:e.thumbnail_url||""})),N=i?.product_videos?.product_video,v=Array.isArray(N)?N.map(e=>({title:e?.title||"",video_file_name:e?.video_file_name||"",thumbnail_image_file_name:e?.thumbnail_image_file_name||"",video_type:e?.video_type||""})):N?[{title:N?.title||"",video_file_name:N?.video_file_name||"",thumbnail_image_file_name:N?.thumbnail_image_file_name||"",video_type:N?.video_type||""}]:[],P=s?.column_data?.REGULAR_FPV||null,G=i?.major_class_description||"",M=i?.minor_class_description||"",w=function(e,r,t,i){let a=e?.toUpperCase()||"",n=r?.toUpperCase()||"",s=i?.short_description?.toUpperCase()||"",l=t?.major_class_code?.toUpperCase()||"";if(!a&&!n)return null;if(n.includes("ACCESSORIES"))return"MISC";if(n.includes("MICROWAVE"))return"MICROWAVES";if(n.includes("WARMING DRAWER"))return"WARMING DRAWERS";if(n.includes("COOKTOP")||n.includes("RANGETOP"))return"COOKTOPS AND RANGETOPS";if(n.includes("OVEN"))return"BUILT IN OVENS";if(a.includes("SMALL APPLIANCES"))return n.includes("WARMING DRAWER")?"WARMING DRAWERS":n.includes("COFFEE")?"COFFEE SYSTEMS":"MISC";if(a.includes("RANGES")||n.includes("RANGE"))return"RANGES";if(a.includes("REFRIGERATORS"))return n.includes("REFRIGERATED DRAWER")&&s.includes("FREEZER")?"FREEZERS":"REFRIGERATORS";if(a.includes("FREEZERS"))return n.includes("ICE MAKERS")?"ICE MAKERS":"FREEZERS";if(a.includes("DISHWASHERS"))return"DISHWASHERS";if(l.includes("BBQ")||n.includes("BARBEQUES"))return"OUTDOOR GRILLS";if(a.includes("HOODS"))return"VENTILATION";if(a.includes("LAUNDRY"))return"LAUNDRY";for(let e of u)if((a.includes(e)||n.includes(e))&&!n.includes("ACCESSORIES"))return e;return"MISC"}(G,M,i,a),D=Array.isArray(i?.related_items?.related_item_key)?i.related_items.related_item_key.map(e=>e.includes(":")?e.split(":")[1]:e):i?.related_items?.related_item_key?[i.related_items.related_item_key].map(e=>e.includes(":")?e.split(":")[1]:e):[];return{slug:d,model:l,minor:M,major:G,name:f,image:I,brand:_,width:c,height:p,depth:m,date:e?.created_at||"2023-01-01",category:r,type:w,rawCategory:G,rawType:M,relatedKeys:D,videos:v,classification:{brand_name:_,pn:d,width_string:c,height_string:p,height:i?.height||null,depth_string:m,nominal_width_in_inches_string:i?.nominal_width_in_inches_string||null,minor_class_code:i?.minor_class_code||"",minor_class_description:i?.minor_class_description||""},marketing_copy:{short_description:R,paragraph_description:E,features:g,image_features:h,spec_table_as_key_value_pairs:O,spec_table_html:O,hierarchical_features_html:S},media:{images:T,pdfs:y},managed_data:{regular_fpv:P}}}(e.data,e.major,e.minor);return Response.json(r,{headers:d()})}catch(e){return console.error("â— Failed to fetch product by slug:",e),Response.json({error:"Failed to fetch product"},{status:500,headers:d()})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/products/[slug]/route",pathname:"/api/products/[slug]",filename:"route",bundlePath:"app/api/products/[slug]/route"},resolvedPagePath:"C:\\Users\\james\\Documents\\MLDwebsite\\catalogue-backend\\app\\api\\products\\[slug]\\route.js",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:R}=p,E="/api/products/[slug]/route";function A(){return(0,s.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:f})}},6318:(e,r,t)=>{t.d(r,{Z:()=>i});let i=new(require("@prisma/client")).PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[176],()=>t(7793));module.exports=i})();