"use strict";(()=>{var e={};e.id=280,e.ids=[280],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5715:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>y,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var o={};t.r(o),t.d(o,{GET:()=>p,OPTIONS:()=>l});var n=t(9303),s=t(8716),a=t(670),i=t(6318);function c(){return{"Access-Control-Allow-Origin":"https://www.mld.com","Access-Control-Allow-Credentials":"true","Access-Control-Allow-Methods":"GET,POST,PUT,PATCH,DELETE,OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization",Vary:"Origin"}}function l(){return new Response(null,{status:204,headers:c()})}async function p(e){let r=(new URL(e.url).searchParams.get("q")||"").toLowerCase();if(!r||""===r.trim())return Response.json({products:[],productTypes:[]},{headers:c()});try{console.log("\uD83D\uDD0E Received search query:",r);let e=r.trim().split(/\s+/).map(e=>({OR:[{model:{contains:e,mode:"insensitive"}},{brand:{contains:e,mode:"insensitive"}},{major:{contains:e,mode:"insensitive"}},{minor:{contains:e,mode:"insensitive"}},{type:{contains:e,mode:"insensitive"}},{data:{path:["marketing_copy","short_description"],string_contains:e}}]})),t=await i.Z.products.findMany({where:{AND:[...e,{NOT:{minor:{contains:"accessories",mode:"insensitive"}}}]},take:20,select:{id:!0,model:!0,brand:!0,major:!0,minor:!0,type:!0,slug:!0}});console.log(`✅ Found ${t.length} matching raw products.`);let o=t.slice(0,5).map(e=>({id:e.id,model:e.model,brand:e.brand,major:e.major,minor:e.minor,type:e.type?.toLowerCase(),slug:e.slug})),n=new Set,s=[];for(let e of t){if(e.major&&e.minor&&e.type){let r=`${e.major}||${e.minor}||${e.type}`;n.has(r)||(n.add(r),s.push({major:e.major,minor:e.minor,type:e.type?.toLowerCase(),category:"appliances"}))}if(s.length>=10)break}return console.log(`✅ Returning ${o.length} products and ${s.length} productTypes.`),Response.json({products:o,productTypes:s},{headers:c()})}catch(e){return console.error("❌ Search API error:",e),Response.json({error:"Server error. Please try again."},{status:500,headers:c()})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:"app/api/search/route"},resolvedPagePath:"C:\\Users\\james\\Documents\\MLDwebsite\\catalogue-backend\\app\\api\\search\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:h}=d,g="/api/search/route";function y(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},6318:(e,r,t)=>{t.d(r,{Z:()=>o});let o=new(require("@prisma/client")).PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[176],()=>t(5715));module.exports=o})();